#!/bin/sh

parse() {
  while [ "$#" -gt 0 ]; do
    case "$1" in
    -h | --help) FLAG_HELP=1; break ;;
    *) ARGS="$@"; break ;;
    esac
  done
}
parse "$@"
set -- $ARGS

show_help() {
  echo 'usage: command [xxx]'
}

if [ "${FLAG_HELP}" = "1" ]; then
  show_help >&2
  exit 1
fi

### main proc
BASE="${HOME}/.cont"
NAME=$(echo "${PWD:-$(pwd)}" | tr '/' '_' | sed 's/^_//')
NAME=$(echo "${NAME}" | tr '[:upper:]' '[:lower:]')
CONF="${BASE}/${NAME}.mk"

if [ ! -e "${CONF}" ]; then
  show_help >&2
  exit 1
fi

make -f "${CONF}" "$@"
